!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("../utils/util"));else if("function"==typeof define&&define.amd)define(["../utils/util"],n);else{var e=n("object"==typeof exports?require("../utils/util"):t["../utils/util"]);for(var r in e)("object"==typeof exports?exports:t)[r]=e[r]}}(this,function(t){return function(t){function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){t.exports=e(25)},,,function(t,n){"use strict";n.__esModule=!0,n.default=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=e(5),o=r(i);n.default=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}()},function(t,n,e){t.exports={default:e(6),__esModule:!0}},function(t,n,e){e(7);var r=e(10).Object;t.exports=function(t,n,e){return r.defineProperty(t,n,e)}},function(t,n,e){var r=e(8);r(r.S+r.F*!e(18),"Object",{defineProperty:e(14).f})},function(t,n,e){var r=e(9),i=e(10),o=e(11),u=e(13),a="prototype",c=function(t,n,e){var f,s,l,h=t&c.F,p=t&c.G,v=t&c.S,d=t&c.P,S=t&c.B,y=t&c.W,m=p?i:i[n]||(i[n]={}),x=m[a],b=p?r:v?r[n]:(r[n]||{})[a];p&&(e=n);for(f in e)s=!h&&b&&void 0!==b[f],s&&f in m||(l=s?b[f]:e[f],m[f]=p&&"function"!=typeof b[f]?e[f]:S&&s?o(l,r):y&&b[f]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[a]=t[a],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((m.virtual||(m.virtual={}))[f]=l,t&c.R&&x&&!x[f]&&u(x,f,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n,e){var r=e(12);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,i){return t.call(n,e,r,i)}}return function(){return t.apply(n,arguments)}}},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,e){var r=e(14),i=e(22);t.exports=e(18)?function(t,n,e){return r.f(t,n,i(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(15),i=e(17),o=e(21),u=Object.defineProperty;n.f=e(18)?Object.defineProperty:function(t,n,e){if(r(t),n=o(n,!0),r(e),i)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(16);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,e){t.exports=!e(18)&&!e(19)(function(){return 7!=Object.defineProperty(e(20)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){t.exports=!e(19)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(16),i=e(9).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,e){var r=e(16);t.exports=function(t,n){if(!r(t))return t;var e,i;if(n&&"function"==typeof(e=t.toString)&&!r(i=e.call(t)))return i;if("function"==typeof(e=t.valueOf)&&!r(i=e.call(t)))return i;if(!n&&"function"==typeof(e=t.toString)&&!r(i=e.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},,function(t,n){t.exports=require("../utils/util")},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var i=e(26),o=r(i),u=e(3),a=r(u),c=e(4),f=r(c),s=e(48),l=r(s),h=e(24),p=6e4,v=1440*p,d=function(){var t=new Date,n=t.getFullYear(),e=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getDate()).slice(-2),i=[n,e,r].join("");return{RiQi:i,JiaoYiShiJianDuan:[{KaiShiShiJian:"0930",JieShuShiJian:"1130",KaiShiRiQi:i,JieShuRiQi:i},{KaiShiShiJian:"1300",JieShuShiJian:"1500",KaiShiRiQi:i,JieShuRiQi:i}],JiHeJingJiaDianShu:15,ShiQu:8,ZuoShou:0}}(),S=function(t,n,e){var r=(0,l.default)(t),i=parseInt(r.substr(0,4),10),o=parseInt(r.substr(4,2),10)-1,u=parseInt(r.substr(6,2),10),a=parseInt(n/100,10)-e,c=n%100;return Date.UTC(i,o,u,a,c)},y=function(){function t(n){(0,a.default)(this,t),this.klineDataStore=new h.DataStore({serviceUrl:"/quote/kline",idProperty:" "}),this.maDataStore=new h.DataStore({serviceUrl:"/indicator/calc",idProperty:" ",otherParams:{name:"MA",text:"MA1:MA(CLOSE,P1);MA2:MA(CLOSE,P2);MA3:MA(CLOSE,P3);MA4:MA(CLOSE,P4);",parameter:"P1=5,P2=10,P3=30,P4=60"}}),this.minDataStore=new h.DataStore({serviceUrl:"/quote/min",idProperty:" "}),this.params=n,this.klineDataStore.dataParser.direct=!0,this.maDataStore.dataParser.direct=!0,this.minDataStore.dataParser.direct=!0}return(0,f.default)(t,[{key:"getKline",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=this.klineDataStore.query((0,o.default)({},this.params,t)).then(function(t){return t[0]&&t[0].Data});return[e,n&&this.getMA(t)]}},{key:"subscribeKline",value:function(t){var n=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.noop,r=this.klineDataStore.subscribe((0,o.default)({},this.params,{start:-1},t),function(r){r instanceof Error||!function(){var i=r[0]&&r[0].Data;e(i),n.getMA((0,o.default)({},{start:-1},t)).then(function(t){if(i&&t&&i[0]&&t[0]&&i[0].ShiJian===t[0].ShiJian){var n=t[0].JieGuo;(0,o.default)(i[0],{MA5:n[0],MA10:n[1],MA20:n[2],MA30:n[3]})}e(i)})}()});return r.cancel=function(){n.klineDataStore.cancel(r.qid)},r}},{key:"getMA",value:function(t){return this.maDataStore.query((0,o.default)({},this.params,t)).then(function(t){return t[0]&&t[0].ShuJu}).catch(function(){return[]})}},{key:"_initMinCache",value:function(t){var n=t.JiaoYiShiJianDuan,e=t.ShiQu;this.minCache={lastClose:t.ZuoShou};var r=this.minCache.minTimes=[];n&&n.length>0&&!function(){var i=0,o=void 0,u=void 0;n.forEach(function(t,n){for(o=S(t.KaiShiRiQi,t.KaiShiShiJian,e),u=S(t.JieShuRiQi,t.JieShuShiJian,e),u<o&&(u+=v),o<i&&(o+=v,u+=v),n>0&&(o+=p);o<=u;)r.push(o),o+=p;i=u});var a=t.JiHeJingJiaDianShu||0;o=r[0];for(var c=1;c<=a;c+=1)r.unshift(o-c*p)}()}},{key:"_updateMinCache",value:function(t,n){var e=this.minCache.minTimes||[],r=this.minCache.minTimes.indexOf(t);if(r>=0)this.minCache[t]=n;else{var i=e[0],o=parseInt((t-i)/v,10),u=o*v;if(r=e.indexOf(t-u),r>=0){for(;r<e.length;){var a=e[r];a+=u,e[r]=a,r+=1}this.minCache[t]=n}}}},{key:"subscribeMin",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.noop;this.minCache=null;var e=this.minDataStore.subscribe(this.params,function(e){if(e&&!(e instanceof Error)&&e.length>0){var r=e[0];1===r.QingPan&&(t.minCache=null),t.minCache||t._initMinCache(r.JiaoYiShiJianDuan?r:d),r=r.Data,r&&r.length>0&&r.forEach(function(n){var e=1e3*n.ShiJian;t._updateMinCache(e,n)}),n(t.minCache)}});return e.cancel=function(){t.minDataStore.cancel(e.qid)},e}},{key:"cancel",value:function(){this.klineDataStore.cancel(),this.maDataStore.cancel(),this.minDataStore.cancel()}}]),t}();n.default=y},function(t,n,e){t.exports={default:e(27),__esModule:!0}},function(t,n,e){e(28),t.exports=e(10).Object.assign},function(t,n,e){var r=e(8);r(r.S+r.F,"Object",{assign:e(29)})},function(t,n,e){"use strict";var r=e(30),i=e(45),o=e(46),u=e(47),a=e(34),c=Object.assign;t.exports=!c||e(19)(function(){var t={},n={},e=Symbol(),r="abcdefghijklmnopqrst";return t[e]=7,r.split("").forEach(function(t){n[t]=t}),7!=c({},t)[e]||Object.keys(c({},n)).join("")!=r})?function(t,n){for(var e=u(t),c=arguments.length,f=1,s=i.f,l=o.f;c>f;)for(var h,p=a(arguments[f++]),v=s?r(p).concat(s(p)):r(p),d=v.length,S=0;d>S;)l.call(p,h=v[S++])&&(e[h]=p[h]);return e}:c},function(t,n,e){var r=e(31),i=e(44);t.exports=Object.keys||function(t){return r(t,i)}},function(t,n,e){var r=e(32),i=e(33),o=e(37)(!1),u=e(41)("IE_PROTO");t.exports=function(t,n){var e,a=i(t),c=0,f=[];for(e in a)e!=u&&r(a,e)&&f.push(e);for(;n.length>c;)r(a,e=n[c++])&&(~o(f,e)||f.push(e));return f}},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(34),i=e(36);t.exports=function(t){return r(i(t))}},function(t,n,e){var r=e(35);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,e){var r=e(33),i=e(38),o=e(40);t.exports=function(t){return function(n,e,u){var a,c=r(n),f=i(c.length),s=o(u,f);if(t&&e!=e){for(;f>s;)if(a=c[s++],a!=a)return!0}else for(;f>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(39),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(39),i=Math.max,o=Math.min;t.exports=function(t,n){return t=r(t),t<0?i(t+n,0):o(t,n)}},function(t,n,e){var r=e(42)("keys"),i=e(43);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,n,e){var r=e(9),i="__core-js_shared__",o=r[i]||(r[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(36);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(49),__esModule:!0}},function(t,n,e){var r=e(10),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}}])});